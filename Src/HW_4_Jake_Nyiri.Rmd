---
title: "HW_4_Jake_Nyiri"
author: "Jake Nyiri"
date: "11/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r}
#initialize libraries and obtain raw data
library(tidyverse)
library(lubridate)
library(broom)
library(here)
library(effsize)

raw_hare_data <- read.csv(here("Data","bonanza_hares.csv"))

```



```{r}
#Create a base dataframe of just the juvenile rabbits with year info pulled out 
juvenile_hare_data <- raw_hare_data %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date)) %>% 
  
  filter(age == "j")

#rename factor levels for cleaner graph labels and code
levels(juvenile_hare_data$sex)[levels(juvenile_hare_data$sex)=="f"] <- "Female"
levels(juvenile_hare_data$sex)[levels(juvenile_hare_data$sex)=="m"] <- "Male"
levels(juvenile_hare_data$grid)[levels(juvenile_hare_data$grid)=="bonrip"] <- "Riparian"
levels(juvenile_hare_data$sex)[levels(juvenile_hare_data$sex)=="bonbs"] <- "Lowland Spruce"
levels(juvenile_hare_data$sex)[levels(juvenile_hare_data$sex)=="bonmat"] <- "Upland Mature"

#Create second base dataframe with NA values removed from female and male rabbits weight
juvenile_hare_data_no_NA <- juvenile_hare_data %>% 
  filter(weight != "NA" & sex != "NA")
```


# BONANZA CREEK LTER
## Juvenile Snowshoe Hares
## Jake Nyiri


**Introduction**

This exploratory analysis examines some of the data collected at multiple Bonanza Creek Experimental Forest Long-Term Ecological Research sites in Alaska from 1999-2010. This is a large-scale ecological and climate research center located in boreal forest and tundra around the city of Fairbanks. Relationships between sex and weight of juvenile snowshoe hares in the area are examined, as well as any potential relationship between weight and limb length.


**Data and Methods**
Counts and measurements of snowshoes hares were collected from trapping regimes at three sites in the LTER over 12 years ([Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative.](https:\\doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14))



```{r}
#Part 1 of assignment-
#Count juvenile hares only trapped for each year
juvenile_trap_data <- juvenile_hare_data %>% 
  
  group_by(year) %>%
  summarize(
    number_trapped = n(),
    )


trapped_mean <- mean(juvenile_trap_data$number_trapped)
trapped_median <- median(juvenile_trap_data$number_trapped)

```
```{r}
first_juvenile_plot <- juvenile_trap_data %>% 
  ggplot(aes(x=year, y=number_trapped))+
  geom_col()

first_juvenile_plot
```

```{r}
#Second part of assignment
#Compare juv hare weights by sex for each site

juv_weights_plot <- juvenile_hare_data %>% 
  
  group_by(grid) %>% 
  ggplot(aes(x=grid, y=weight))+
  geom_point()+
  facet_wrap(~sex)

juv_weights_plot
```

```{r}
#Third part of assignment
#compare stats for male and female juvenile snowshoe hares
#Then run t-test and Cohen's

bunny_sex_compare <- juvenile_hare_data_no_NA %>% 
  group_by(sex) %>% 
  summarize(
    mean_weight = mean(weight),
    sd_weight = sd(weight),
    number_trapped = n())

bunny_sex_compare
```
```{r, include = FALSE}
#Check the assumptions of the rabbit data before trying a t-test
#Don't include in final markdown document
bunny_normal_test<-juvenile_hare_data_no_NA %>% 
  ggplot(aes(sample=weight))+
  geom_qq(aes(color=sex))

bunny_normal_test
#Not the best but close enough

```

```{r}
#Run tests (t-test and cohens d)
#First need to pull out weights by sex

female_weights <- juvenile_hare_data_no_NA %>% 
  filter(sex=="Female") %>% 
  pull(weight)

male_weights <- juvenile_hare_data_no_NA %>% 
  filter(sex=="Male") %>% 
  pull(weight)

bunny_t_test <- t.test(female_weights,male_weights)
bunny_t_test

bunny_cohen <- cohen.d(female_weights, male_weights)
bunny_cohen

```

```{r}
juvenile_hare_ft_and_weight <- juvenile_hare_data_no_NA %>% 
  filter(hindft != "NA")

foot_weight_plot<- juvenile_hare_ft_and_weight %>% 
  ggplot(aes(x=weight, y=hindft))+
  geom_point()

foot_weight_plot

```

```{r}
bunny_lm <- lm(hindft ~ weight, data = juvenile_hare_ft_and_weight)

bunny_correlation <- cor.test(juvenile_hare_ft_and_weight$hindft, juvenile_hare_ft_and_weight$weight)

bunny_lm_plot <- juvenile_hare_ft_and_weight %>% 
  ggplot(aes(x=weight, y=hindft))+
  geom_point()+
  geom_smooth(method = "lm")

bunny_lm_plot
bunny_correlation
```


